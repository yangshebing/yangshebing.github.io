<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.9.0"><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>Invalid Executable：Xcode16 Bitcode 解决方案 | 杨社兵的技术博客</title><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/4.2.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/grids-responsive-min.css"><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="/css/donate.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.0.0/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">Invalid Executable：Xcode16 Bitcode 解决方案</h1><a id="logo" href="/.">杨社兵的技术博客</a><p class="description">Spencer Yang</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">Invalid Executable：Xcode16 Bitcode 解决方案</h1><div class="post-meta">Apr 21, 2025<span> | </span><span class="category"><a href="/categories/Swift/">Swift</a></span><script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> Hits</span></span></div><a data-disqus-identifier="2025/04/21/Invalid Executable：Xcode16 Bitcode 解决方案/" href="/2025/04/21/Invalid Executable：Xcode16 Bitcode 解决方案/#disqus_thread" class="disqus-comment-count"></a><div class="post-content"><p>从2025年4月24号开始，必须使用Xcode16及以上版本构建App上传App Store Connect提交或发布。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Beginning April 24, 2025, apps uploaded to App Store Connect must be built with Xcode 16 or later using an SDK for iOS 18, iPadOS 18, tvOS 18, visionOS 2, or watchOS 11.</span><br></pre></td></tr></table></figure>
<p>由于苹果强制需要Xcode16构建App，这两天我不得不将Xcode15升级到Xcode16，升级之后在打TF包上传App的时候出现了Invalid Executable报错。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Validation failed</span><br><span class="line">	Asset validation failed</span><br><span class="line">	Invalid Executable. The executable &apos;XXX.app/Frameworks/XXSDK.framework/XXSDK&apos; contains bitcode. (ID: xxxx-xxx-xxx-xxxx)</span><br></pre></td></tr></table></figure>
<p>出现这个问题的原因是某个三方库我们引用的是旧版本，里面包含了Bitcode。Xcode16已默认禁用Bitcode编译选项了，因为我们之前也通过Podfile中的钩子把所有三方库的ENABLE_BITCODE选项设置成YES，但是Xcode16在上传包的时候依然报错，说明ENABLE_BITCODE设置确实不可用。</p>
<h4 id="一、Bitcode-报错解决方案"><a href="#一、Bitcode-报错解决方案" class="headerlink" title="一、Bitcode 报错解决方案"></a>一、Bitcode 报错解决方案</h4><p>方案一：手动移除指定三方库的Bitcode（终端操作，适用于单个三方库）</p>
<p>（1）使用find命令，找到SDK文件路径：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find /path/project -name &quot;XXSDK.framework&quot;</span><br></pre></td></tr></table></figure>
<p>（2）查看是否包含Bitcode：（这步可省略，既然都报错了，那必然是包含）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// 注意：XXSDK 代表三方SDK的名字，输出非0代表包含Bitcode</span><br><span class="line">otool -l XXSDK | grep __LLVM | wc -l</span><br></pre></td></tr></table></figure>
<p>（3）移除Bitcode：关键一步</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /Path/XXSDK/XXSDK.framework</span><br><span class="line">xcrun bitcode_strip -r XXSDK -o XXSDK</span><br></pre></td></tr></table></figure>
<p>方案二：在Podfile文件中新增 post_install hook（适用于cocoapods包管理场景）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">post_install do |installer|  </span><br><span class="line">  bitcode_strip_path = `xcrun --find bitcode_strip`.chop!  </span><br><span class="line">  </span><br><span class="line">  # 移除 Bitcode 操作：上面方案一中的单个framework移除Bitcode同理</span><br><span class="line">  def strip_bitcode_from_framework(bitcode_strip_path, framework_relative_path)  </span><br><span class="line">    framework_path = File.join(Dir.pwd, framework_relative_path)  </span><br><span class="line">    command = &quot;#&#123;bitcode_strip_path&#125; -r #&#123;framework_path&#125; -o #&#123;framework_path&#125;&quot;  </span><br><span class="line">    system(command)  </span><br><span class="line">  end</span><br><span class="line">  </span><br><span class="line">  # 指定需处理的SDK 文件Path（根据项目实际目录修改）</span><br><span class="line">  framework_paths = [  </span><br><span class="line">    &quot;/Pods/XXSDK/XXSDK.framework/XXSDK&quot;,  </span><br><span class="line">  ]  </span><br><span class="line">  </span><br><span class="line">  # 逐个framework移除Bitcode</span><br><span class="line">  framework_paths.each  do |path| </span><br><span class="line">  	strip_bitcode_from_framework(bitcode_strip_path, path) </span><br><span class="line">  end</span><br><span class="line">end</span><br></pre></td></tr></table></figure>
<p>方案三：升级三方SDK</p>
<p>三方库的升级会涉及到很多无法评估的线上问题，尤其是大型App，这个根据自身情况来决定，建议考虑升级三方SDK到去除Bitcode的最小版本。</p>
<p>综上所述，我们推荐方案优先级如下所示，可以自己酌情选择最适合自己的方案：</p>
<p><strong>升级三方SDK &gt; Cocoapods自动化脚本 &gt; 手动移除Bitcode</strong></p>
<p>到这里 Bitcode 报错问题便算是解决了！</p>
<h4 id="二、Xcode16-在-Run-Script-中指定自定义Ruby版本（适用于在Run-Script中执行Ruby脚本的场景）"><a href="#二、Xcode16-在-Run-Script-中指定自定义Ruby版本（适用于在Run-Script中执行Ruby脚本的场景）" class="headerlink" title="二、Xcode16 在 Run Script 中指定自定义Ruby版本（适用于在Run Script中执行Ruby脚本的场景）"></a>二、Xcode16 在 Run Script 中指定自定义Ruby版本（适用于在Run Script中执行Ruby脚本的场景）</h4><p>由于Xcode16在执行Ruby脚本的过程中，默认取的是系统自带的Ruby 2.6的版本（/usr/bin/ruby），在Run Script执行ruby脚本过程中很容易因为一些系统库的差异导致报错，所以一般我们都需要把系统的Ruby切换成Ruby3.x版本，在Mac过程中我们可以使用rbenv来解决自定义Ruby版本的问题。</p>
<p>（1）安装rbenv</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install rbenv</span><br></pre></td></tr></table></figure>
<p>（2）使用rbenv安装ruby 3.x版本</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rbenv install 3.2.4</span><br></pre></td></tr></table></figure>
<p>（3）全局切换Ruby版本（这里也可以局部切换Ruby版本，关于其他使用方式可以自行搜索解决）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rbenv global 3.2.4</span><br></pre></td></tr></table></figure>
<p>（4）由于Xcode取的是/usr/bin/ruby，所以我们还需要做一步才能让Xcode在执行Run Script脚本的过程中使用我们安装的自定义Ruby版本</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 下面的/Users/XX/要替换成自己的用户目录</span><br><span class="line">sudo ln -s /Users/XX/.rbenv/shims/ruby /usr/local/bin/ruby</span><br></pre></td></tr></table></figure>
<hr>
<p>更多好文推荐，欢迎关注 <strong>《iOS开发秘籍》</strong> 公众号，获取最新的内容</p>
<p><strong>本文内容中部分来自网络，后续会持续更新完善。欢迎一起学习交流！</strong></p>
<p><strong>如需转载，请注明出处</strong></p>
<p><a href="https://blog.csdn.net/yangshebing21/article/details/147378275" target="_blank" rel="noopener">Invalid Executable：Xcode16 Bitcode 解决方案</a></p>
</div><script type="text/javascript" src="/js/share.js?v=0.0.0" async></script><a data-url="http://www.yangshebing.com/2025/04/21/Invalid Executable：Xcode16 Bitcode 解决方案/" data-id="cmcy306g6003ewz499vfuhspx" class="article-share-link">分享到</a><div class="tags"><a href="/tags/iOS/">iOS</a><a href="/tags/Xcode/">Xcode</a><a href="/tags/Swift/">Swift</a><a href="/tags/iPhone/">iPhone</a></div><div class="post-nav"><a href="/2025/05/11/Swift面试题2025（附答案）/" class="pre">Swift面试题2025（附答案）</a><a href="/2025/04/13/Swift无用代码查找/" class="next">Swift 无用代码查找</a></div><div class="post-donate"><div id="donate_board" class="donate_bar center"><a id="btn_donate" href="javascript:;" title="打赏" class="btn_donate"></a><div class="donate_txt"> &uarr;<br>小火箭走一波，一瓶可乐鼓励下~~~^_^~~~~<br></div></div><div id="donate_guide" class="donate_bar center hidden"><img src="https://img-blog.csdnimg.cn/8253848a613e4b1693403f1ec363ed56.png" title="微信打赏"></div><script type="text/javascript">document.getElementById('btn_donate').onclick = function(){
    $('#donate_board').addClass('hidden');
    $('#donate_guide').removeClass('hidden');
}</script></div><div id="disqus_thread"><script>var disqus_shortname = 'yangshebing';
var disqus_identifier = '2025/04/21/Invalid Executable：Xcode16 Bitcode 解决方案/';
var disqus_title = 'Invalid Executable：Xcode16 Bitcode 解决方案';
var disqus_url = 'http://www.yangshebing.com/2025/04/21/Invalid Executable：Xcode16 Bitcode 解决方案/';
(function() {
  var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//yangshebing.disqus.com/count.js" async></script></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank" class="search-form"><input type="text" name="q" maxlength="20" placeholder="搜索"><input type="hidden" name="sitesearch" value="http://www.yangshebing.com"></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Objective-C/">Objective-C</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Others/">Others</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Swift/">Swift</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最新发布</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2025/07/05/iOS开发弱网调试/">iOS开发弱网调试</a></li><li class="post-list-item"><a class="post-list-link" href="/2025/07/05/你最想知道的 Xcode 26 AI 助手尝鲜攻略/">你最想知道的 Xcode 26 AI 助手尝鲜攻略</a></li><li class="post-list-item"><a class="post-list-link" href="/2025/05/11/Swift面试题2025（附答案）/">Swift面试题2025（附答案）</a></li><li class="post-list-item"><a class="post-list-link" href="/2025/04/21/Invalid Executable：Xcode16 Bitcode 解决方案/">Invalid Executable：Xcode16 Bitcode 解决方案</a></li><li class="post-list-item"><a class="post-list-link" href="/2025/04/13/Swift无用代码查找/">Swift 无用代码查找</a></li><li class="post-list-item"><a class="post-list-link" href="/2025/04/12/ITMS-91061 Missing privacy manifest for third-party SDKs/">ITMS-91061 Missing privacy manifest for third-party SDKs</a></li><li class="post-list-item"><a class="post-list-link" href="/2024/12/01/Swift面试题2024（附答案）/">Swift面试题2024（附答案）</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/08/25/Swift算法面试题2022（附答案）/">Swift算法面试题2022（附答案）</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/08/03/iOS-编译一览/">iOS 编译一览</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/04/29/iOS-开发必备tips/">iOS 开发必备tips</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-comment-o"> 最近评论</i></div><script type="text/javascript" src="//yangshebing.disqus.com/recent_comments_widget.js?num_items=5&amp;hide_avatars=1&amp;avatar_size=32&amp;excerpt_length=20&amp;hide_mods=1"></script></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="http://www.liuchungui.com/" title="刘春桂的技术博客" target="_blank">刘春桂的技术博客</a><ul></ul><a href="http://blog.csdn.net/yangshebing21" title="我的CSDN博客" target="_blank">我的CSDN博客</a><ul></ul><a href="http://weibo.com/yangshebing" title="我的微博" target="_blank">我的微博</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">© <a href="/." rel="nofollow">杨社兵的技术博客.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="/css/jquery.fancybox.css?v=0.0.0"><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create','UA-112380437-1','auto');ga('send','pageview');
</script><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?ad5152aa4d2164ce1cc1c3fbada6f5ec";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
  })();
</script><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>